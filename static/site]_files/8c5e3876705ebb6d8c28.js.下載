(window.webpackJsonp=window.webpackJsonp||[]).push([[355],{1962:function(t,e,n){"use strict";n.r(e);var r=n(9307),o=n(5236);for(var c in o)["default"].indexOf(c)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(c);n(8102);var l=n(2),component=Object(l.a)(o.default,r.a,r.b,!1,null,null,null);e.default=component.exports},3920:function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.getShareLinkUrl=void 0;var r=(0,n(42).getInstance)("");e.getShareLinkUrl=function(data){return r.post("/v1/mix/public/getShareContent",data)}},5236:function(t,e,n){"use strict";n.r(e);var r=n(5237),o=n.n(r);for(var c in r)["default"].indexOf(c)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(c);e.default=o.a},5237:function(t,e,n){"use strict";var r=n(18),o=n(6),c=n(7),l=n(5),T=n(8),f=n(9),d=n(0),S=n(21),h=n(1);d(e,"__esModule",{value:!0}),e.default=void 0;var y=h(n(177)),_=h(n(76)),E=h(n(4)),m=h(n(5238)),v=h(n(5246)),I=h(n(5249)),A=h(n(8064)),L=h(n(5287)),Y=n(31),R=n(12),C=n(596),G=n(595),O=(n(411),function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var n=k(e);if(n&&n.has(t))return n.get(t);var o={},c=d&&l;for(var T in t)if("default"!==T&&Object.prototype.hasOwnProperty.call(t,T)){var desc=c?l(t,T):null;desc&&(desc.get||desc.set)?d(o,T,desc):o[T]=t[T]}o.default=t,n&&n.set(t,o);return o}(n(604))),U=h(n(3943));function k(t){if("function"!=typeof S)return null;var e=new S,n=new S;return(k=function(t){return t?n:e})(t)}function P(object,t){var e=o(object);if(c){var n=c(object);t&&(n=n.filter((function(t){return l(object,t).enumerable}))),e.push.apply(e,n)}return e}function D(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?P(Object(source),!0).forEach((function(e){(0,E.default)(t,e,source[e])})):T?f(t,T(source)):P(Object(source)).forEach((function(e){d(t,e,l(source,e))}))}return t}var w={layout:"trade",name:"FutureStrategyTradePage",components:{"strategy-detail":m.default,"strategy-depth-and-history":v.default,"strategy-aside":A.default,"current-strategy-and-history":I.default,StrategyKline:L.default},data:function(){return{asks:[],bids:[],wsBookId:""}},computed:D(D({},(0,R.mapGetters)(["isLogin"])),(0,R.mapGetters)("strategy",{spotBaseInfo:C.STRATEGY_GETTERS_TYPE.STRATEGY_BASE_SPOT_CONFIG,getSymbolBaseInfo:C.STRATEGY_GETTERS_TYPE.GET_STRATEGY_BASE_SYMBOL_INFO})),methods:D(D(D({},(0,R.mapMutations)("strategy",{setAllTicker:C.STRATEGY_MUTATIONS_TYPE.SET_ALL_TICKER,updateUserWallets:C.STRATEGY_MUTATIONS_TYPE.UPDATE_USER_WALLETS,setSupportedList:C.STRATEGY_MUTATIONS_TYPE.SET_SUPPORTED_LIST,updateSpotDepth:C.STRATEGY_MUTATIONS_TYPE.UPDATE_SPOT_DEPTH,setCurrentStrategyList:C.STRATEGY_MUTATIONS_TYPE.SET_CURRENT_STRATEGY,setHistoryStrategyList:C.STRATEGY_MUTATIONS_TYPE.SET_HISTORY_STRATEGY,clearAll:C.STRATEGY_MUTATIONS_TYPE.CLEAR_ALL})),(0,R.mapActions)("strategy",{setSymbol:C.STRATEGY_ACTIONS_TYPE.SET_SYMBOL,initSupportedSymbols:C.STRATEGY_ACTIONS_TYPE.INIT_SUPPORTED_SYMBOLS,initBusinessConfig:C.STRATEGY_ACTIONS_TYPE.INIT_BUSINESS_CONFIG,getFutureAssets:C.STRATEGY_ACTIONS_TYPE.GET_FUTURE_ASSETS})),{},{beginTask:function(){var t=this;!function e(){t.getFutureAssets().then((function(){t._taskTimer=setTimeout(e,2e4)}))}()},initWebsocket:function(t){var e=this,n=this.$heroMix.getInstance();n.registerEventListener("open",(function(){e.subscribeCommonData(),t&&t()})),n.begin()},subscribeCommonData:function(){var t=this;this.$heroMix.getInstance().subscribe("tickerAll",{instType:"mc",instId:"default"},(function(data){data.data&&t.setAllTicker(data.data)})),this.isLogin&&this.getFutureAssets().then((function(){t.beginTask()}))},subscribeSymbolData:function(t){var e=this,n=this.getSymbolBaseInfo(t),r=n.businessLine,o=n.symbolCode,c=this.$heroMix.getInstance();if(c.changeProduct(t),this.wsSymbolDataListenerId&&c.removeEventListener("open",this.wsSymbolDataListenerId),this.wsSymbolDataListenerId=c.registerEventListener("open",(function(){e.wsBookId&&c.unsubscribe(e.wsBookId),e.wsBookId=c.subscribe("depth5",{instType:(0,G.getBusinessLineInstType)(r),instId:o},(function(data){var t=data.data[0];data.arg.instId===o&&e.updateSpotDepth(t)}))})),this.isLogin){var l=getCookie("bt_sessonid")||getCookie("bt_rtoken");this.wsUserDataListenerId&&c.removeEventListener("open",this.wsUserDataListenerId),this.wsUserDataListenerId=c.registerEventListener("open",(function(){c.login(l,(function(data){if(0===data.code){var param={instType:(0,G.getBusinessLineCode)(r),instId:"default"};c.subscribe("currentStrategy",param,(function(data){"snapshot"===data.action?e.setCurrentStrategyList((function(){return data.data})):"update"===data.action&&e.setCurrentStrategyList((function(t){var e=(0,_.default)(t);return data.data.forEach((function(t){var n=e.findIndex((function(e){return e.strategyId===t.strategyId}));n>=0?-1==+t.version?e.splice(n,1):e[n]=t:e.push(t)})),e.sort((function(a,b){return+b.createTime-+a.createTime})),e}))}))}}))}))}}}),beforeRouteUpdate:function(t,e,n){var r=t.params.symbolId;if(r){var o=this.getSymbolBaseInfo(r);this.setSymbol({symbolId:r,businessLine:o.businessLine}),this.subscribeSymbolData(r),n()}},mounted:function(){var t=this;this._taskTimer=null,window.isReadyPromise.then((function(){(0,Y.hideGlobalLoading)(),(0,Y.clearLauncher)(),t.setSymbol({symbolId:""}),t.initWebsocket();var e=t.$route.params.symbolId,n=[10];if(t.initBusinessConfig(n),t.initSupportedSymbols({businessLines:n,gridType:1}).then((function(n){var r=n.find((function(t){return t.symbolId===e}));if(r)t.setSymbol({symbolId:e,businessLine:r.businessLine}).then((function(){t.subscribeSymbolData(e)}));else{var o=n[0].symbolId;t.$router.push(t.$i18n.path("future-strategy/"+o))}})),1==+O.default.get(O.CacheKey.FUTURE_STRATEGY_GUIDE)){var r=t.$useDialog()(U.default,{type:"future",auto:!0}),o=(0,y.default)(r,2),c=o[0],l=o[1];c.then((function(t){"confirm"===t.type&&(t.check&&O.default.set(O.CacheKey.FUTURE_STRATEGY_GUIDE,0),l())}))}})).catch((function(t){console.log(">>> system error:",t)}))},beforeDestroy:function(){this.$heroMix.getInstance().selfDestruct(),this.clearAll(),this._taskTimer&&(clearTimeout(this._taskTimer),this._taskTimer=null)}};e.default=w},7075:function(t,e,n){},8102:function(t,e,n){"use strict";n(7075)},9307:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var r=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"strategy-symbolId-page"},[e("div",{staticClass:"strategy-bit-market"},[e("strategy-detail")],1),this._v(" "),e("div",{staticClass:"strategy-aside"},[e("strategy-aside")],1),this._v(" "),e("div",{staticClass:"strategy-depth-history"},[e("strategy-depth-and-history",{staticClass:"strategy-layout-item strategy-depth-and-history"})],1),this._v(" "),e("div",{staticClass:"strategy-kline-chart"},[e("strategy-kline")],1),this._v(" "),e("div",{staticClass:"strategy-cur-history"},[e("current-strategy-and-history")],1)])},o=[]}}]);
//# sourceMappingURL=8c5e3876705ebb6d8c28.js.map