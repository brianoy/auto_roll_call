(window.webpackJsonp=window.webpackJsonp||[]).push([[506],{1998:function(t,e,n){"use strict";n.r(e);var o=n(9343),r=n(5691);for(var c in r)["default"].indexOf(c)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(c);n(8538);var d=n(2),component=Object(d.a)(r.default,o.a,o.b,!1,null,null,null);e.default=component.exports},5691:function(t,e,n){"use strict";n.r(e);var o=n(5692),r=n.n(o);for(var c in o)["default"].indexOf(c)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(c);e.default=r.a},5692:function(t,e,n){"use strict";var o=n(6),r=n(7),c=n(5),d=n(8),l=n(9),f=n(0),T=n(1);f(e,"__esModule",{value:!0}),e.default=void 0;var _=T(n(76)),S=T(n(4)),E=T(n(5693)),h=T(n(8490)),y=T(n(7290)),m=T(n(8493)),P=T(n(7297)),I=T(n(8511)),v=T(n(8526)),U=T(n(7292)),O=T(n(7308)),C=T(n(8528)),A=T(n(8534)),L=n(12),D=n(599),k=n(598),N=n(31),w=n(1925);function R(object,t){var e=o(object);if(r){var n=r(object);t&&(n=n.filter((function(t){return c(object,t).enumerable}))),e.push.apply(e,n)}return e}function M(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?R(Object(source),!0).forEach((function(e){(0,S.default)(t,e,source[e])})):d?l(t,d(source)):R(Object(source)).forEach((function(e){f(t,e,c(source,e))}))}return t}var Y={name:"coin",scrollToTop:!0,data:function(){return{wsSymbolDataListenerId:null,wsUserDataListenerId:null,wsBookId:""}},components:{"base-block":E.default,"base-column":h.default,"trade-history":y.default,"trade-detail":m.default,"trade-depth":P.default,"entrust-history":I.default,"trade-depth-and-history":v.default,"spot-kline":function(){return Promise.all([n.e(4),n.e(5),n.e(599)]).then(n.bind(null,9060))},TradeOrderPlacerSingle:C.default,TradeOrderPlacerSplit:A.default,TradeMarketList:U.default,SpotCountdown:O.default},computed:M(M(M({},(0,L.mapState)({tradeInfo:function(t){return t.spot.marketDetail},layout:function(t){return t.spot.layout},symbolId:function(t){return t.spot.symbolId}})),(0,L.mapGetters)(["isLogin","getLang"])),(0,L.mapGetters)("spot",{spotConfig:D.SPOT_GETTERS_TYPE.SPOT_CONFIG,spotTicker:D.SPOT_GETTERS_TYPE.SPOT_TICKER})),watch:{spotTicker:{handler:function(t){var e=t.symbolCode,n=t.price,o=e?e.toUpperCase():"",r=(0,w.getSeoInfo)(this.getLang,o);document.title="".concat(n||"-"," |  ").concat(r.title)},deep:!0}},beforeRouteUpdate:function(t,e,n){var o=t.params.symbolId;this.setSymbol(o),this.subscribeSymbolData(o),n()},methods:M(M(M(M({},(0,L.mapMutations)({initLayout:"SET_LAYOUT"})),(0,L.mapActions)("spot",{initUserConfig:D.SPOT_ACTIONS_TYPE.INIT_ALL})),(0,L.mapMutations)("spot",{setSymbol:D.SPOT_MUTATIONS_TYPE.SET_SYMBOL,setSpotConfigList:D.SPOT_MUTATIONS_TYPE.SET_SPOT_CONFIG_LIST,setAllTicker:D.SPOT_MUTATIONS_TYPE.SET_ALL_TICKER,setSpotConfig:D.SPOT_MUTATIONS_TYPE.SET_SPOT_CONFIG,updateUserWallets:D.SPOT_MUTATIONS_TYPE.UPDATE_USER_WALLETS,updateUserCurrentEntrusts:D.SPOT_MUTATIONS_TYPE.UPDATE_USER_CURRENT_ENTRUSTS,updateUserHistoryEntrusts:D.SPOT_MUTATIONS_TYPE.UPDATE_USER_HISTORY_ENTRUSTS,updateUserCurrentPlans:D.SPOT_MUTATIONS_TYPE.UPDATE_USER_CURRENT_PLANS,updateUserHistoryPlans:D.SPOT_MUTATIONS_TYPE.UPDATE_USER_HISTORY_PLANS,updateUserAccountDeal:D.SPOT_MUTATIONS_TYPE.UPDATE_USER_ACCOUNT_DEAL,clearSpotState:D.SPOT_MUTATIONS_TYPE.CLEAR_TRADE_STATE,updateTradeHistory:D.SPOT_MUTATIONS_TYPE.UPDATE_SPOT_TRADE_HISTORY,updateSpotDepth:D.SPOT_MUTATIONS_TYPE.UPDATE_SPOT_DEPTH})),{},{initWebsocket:function(t){var e=this,n=this.$heroMix.getInstance();n.registerEventListener("open",(function(){e.subscribeCommonData(),t&&t()})),n.begin()},subscribeCommonData:function(){var t=this,e=this.$heroMix.getInstance();if(e.subscribe("tickerAll",{instType:"sp",instId:"default"},(function(data){data.data&&t.setAllTicker(data.data)})),this.isLogin){var n=(0,N.getCookie)("bt_sessonid")||(0,N.getCookie)("bt_rtoken");e.login(n,(function(data){0===data.code&&e.subscribe("account",{instType:"spbl",instId:"default"},(function(data){t.updateUserWallets(data.data)}))}))}},subscribeSymbolData:function(t){var e=this,n=this.$heroMix.getInstance();if(n.changeProduct(t),this.wsSymbolDataListenerId&&n.removeEventListener("open",this.wsSymbolDataListenerId),this.wsSymbolDataListenerId=n.registerEventListener("open",(function(){n.subscribe("trade",{instType:"sp",instId:e.spotConfig.symbolCode},(function(data){"snapshot"===data.action?e.updateTradeHistory((function(){return data.data})):"update"===data.action&&e.updateTradeHistory((function(t){return[].concat((0,_.default)(data.data),(0,_.default)(t)).splice(0,50)}))})),e.wsBookId&&n.unsubscribe(e.wsBookId),e.wsBookId=n.subscribe("books15",{instType:"sp",instId:e.spotConfig.symbolCode},(function(data){var t=data.data[0];data.arg.instId===e.spotConfig.symbolCode&&e.updateSpotDepth(t)}))})),this.isLogin){var o=(0,N.getCookie)("bt_sessonid")||(0,N.getCookie)("bt_rtoken");this.wsUserDataListenerId&&n.removeEventListener("open",this.wsUserDataListenerId),this.wsUserDataListenerId=n.registerEventListener("open",(function(){n.login(o,(function(data){if(0===data.code){var param={instType:"spbl",instId:e.symbolId};n.subscribe("currentEntrusts",param,(function(data){"snapshot"===data.action?e.updateUserCurrentEntrusts((function(){return data.data})):"update"===data.action&&e.updateUserCurrentEntrusts((function(t){var e=(0,_.default)(t);return data.data.forEach((function(t){var n=e.findIndex((function(e){return e.id===t.id}));n>=0?"-1"===t.version?e.splice(n,1):e[n]=t:e.push(t)})),e.sort((function(a,b){return b.createTime-a.createTime})),e}))})),n.subscribe("currentPlans",param,(function(data){"snapshot"===data.action?e.updateUserCurrentPlans((function(){return data.data})):"update"===data.action&&e.updateUserCurrentPlans((function(t){var e=(0,_.default)(t);return data.data.forEach((function(t){var n=e.findIndex((function(e){return e.id===t.id}));n>=0?-1==+t.version?e.splice(n,1):e[n]=t:e.push(t)})),e.sort((function(a,b){return b.createTime-a.createTime})),e}))})),n.subscribe("historyEntrusts",param,(function(data){"snapshot"===data.action?e.updateUserHistoryEntrusts((function(){return data.data})):"update"===data.action&&e.updateUserHistoryEntrusts((function(t){return[].concat((0,_.default)(data.data),(0,_.default)(t)).splice(0,20)}))})),n.subscribe("historyPlans",param,(function(data){"snapshot"===data.action?e.updateUserHistoryPlans((function(){return data.data})):"update"===data.action&&e.updateUserHistoryPlans((function(t){return[].concat((0,_.default)(data.data),(0,_.default)(t)).splice(0,20)}))})),n.subscribe("userAccountDeal",param,(function(data){"snapshot"===data.action?e.updateUserAccountDeal((function(){return data.data})):"update"===data.action&&e.updateUserAccountDeal((function(t){return[].concat((0,_.default)(data.data),(0,_.default)(t)).splice(0,50)}))}))}}))}))}}}),mounted:function(){var t=this;window.isReadyPromise.then((function(){t.initLayout(),(0,N.hideGlobalLoading)(),(0,N.clearLauncher)(),t.setSymbol(""),t.initWebsocket();var e=t.$route.params.symbolId;(0,k.allSymbol)().then((function(n){if("00000"===n.code&&n.data){var o=n.data[0].symbolDTOList||[];if(o.length>0)if(t.setSpotConfigList(o),o.find((function(t){return t.symbolId===e})))t.setSymbol(e),t.subscribeSymbolData(e);else{var r=o[0].symbolId;console.log(">>>",r),t.$router.push(t.$i18n.path("spot/"+r))}else console.log(">>> invalid spot config list!!!")}else console.log(">>> spot config list error:",n.msg)})).catch((function(t){console.error(">>> spot config system error:",t)}))}))},beforeDestroy:function(){this.clearSpotState(),this.$heroMix.getInstance().selfDestruct()}};e.default=Y},7321:function(t,e,n){},8538:function(t,e,n){"use strict";n(7321)},9343:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return r}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("client-only",[n("div",{staticClass:"spot-trade__wrapper"},[n("div",{staticClass:"spot-trade__layout",class:[t.layout]},[n("div",{staticClass:"spot-trade__layout-item trade-detail"},[n("trade-detail")],1),t._v(" "),"center"===t.layout?n("div",{staticClass:"spot-trade__layout-item trade-market"},[n("trade-market-list")],1):t._e(),t._v(" "),n("div",{staticClass:"spot-trade__layout-item trade-kline"},[n("spot-kline"),t._v(" "),1==+t.spotTicker.status?n("spot-countdown"):t._e()],1),t._v(" "),n("div",{staticClass:"spot-trade__layout-item trade-depth-and-history"},[n("trade-depth-and-history")],1),t._v(" "),n("div",{staticClass:"spot-trade__layout-item trade-order"},["center"!==t.layout?n("trade-order-placer-single"):n("trade-order-placer-split")],1),t._v(" "),n("div",{staticClass:"spot-trade__layout-item trade-record"},[n("entrust-history")],1)])])])},r=[]}}]);
//# sourceMappingURL=b4476e66e960d3429404.js.map