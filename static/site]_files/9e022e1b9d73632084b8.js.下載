(window.webpackJsonp=window.webpackJsonp||[]).push([[485],{2e3:function(t,e,n){"use strict";n.r(e);var r=n(9345),o=n(5761);for(var c in o)["default"].indexOf(c)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(c);n(8548);var d=n(2),component=Object(d.a)(o.default,r.a,r.b,!1,null,null,null);e.default=component.exports},5761:function(t,e,n){"use strict";n.r(e);var r=n(5762),o=n.n(r);for(var c in r)["default"].indexOf(c)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(c);e.default=o.a},5762:function(t,e,n){"use strict";var r=n(18),o=n(6),c=n(7),d=n(5),f=n(8),l=n(9),T=n(0),S=n(21),y=n(1);T(e,"__esModule",{value:!0}),e.default=void 0;var h=y(n(177)),_=y(n(76)),E=y(n(4)),I=y(n(5238)),v=y(n(5246)),m=y(n(5249)),A=y(n(8539)),L=y(n(5287)),Y=n(31),O=n(12),R=n(596),C=(n(595),function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var n=P(e);if(n&&n.has(t))return n.get(t);var o={},c=T&&d;for(var f in t)if("default"!==f&&Object.prototype.hasOwnProperty.call(t,f)){var desc=c?d(t,f):null;desc&&(desc.get||desc.set)?T(o,f,desc):o[f]=t[f]}o.default=t,n&&n.set(t,o);return o}(n(604))),G=y(n(3943));function P(t){if("function"!=typeof S)return null;var e=new S,n=new S;return(P=function(t){return t?n:e})(t)}function k(object,t){var e=o(object);if(c){var n=c(object);t&&(n=n.filter((function(t){return d(object,t).enumerable}))),e.push.apply(e,n)}return e}function D(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(Object(source),!0).forEach((function(e){(0,E.default)(t,e,source[e])})):f?l(t,f(source)):k(Object(source)).forEach((function(e){T(t,e,d(source,e))}))}return t}var U={layout:"trade",name:"SpotStrategyTradePage",components:{"strategy-detail":I.default,"strategy-depth-and-history":v.default,"strategy-aside":A.default,"current-strategy-and-history":m.default,StrategyKline:L.default},data:function(){return{asks:[],bids:[],wsBookId:""}},computed:D(D({},(0,O.mapGetters)(["isLogin"])),(0,O.mapGetters)("strategy",{spotBaseInfo:R.STRATEGY_GETTERS_TYPE.STRATEGY_BASE_SPOT_CONFIG,getSpotBaseInfo:R.STRATEGY_GETTERS_TYPE.GET_STRATEGY_BASE_SYMBOL_INFO})),methods:D(D(D({},(0,O.mapMutations)("strategy",{setAllTicker:R.STRATEGY_MUTATIONS_TYPE.SET_ALL_TICKER,updateUserWallets:R.STRATEGY_MUTATIONS_TYPE.UPDATE_USER_WALLETS,setSupportedList:R.STRATEGY_MUTATIONS_TYPE.SET_SUPPORTED_LIST,updateSpotDepth:R.STRATEGY_MUTATIONS_TYPE.UPDATE_SPOT_DEPTH,setCurrentStrategyList:R.STRATEGY_MUTATIONS_TYPE.SET_CURRENT_STRATEGY,setHistoryStrategyList:R.STRATEGY_MUTATIONS_TYPE.SET_HISTORY_STRATEGY,clearAll:R.STRATEGY_MUTATIONS_TYPE.CLEAR_ALL})),(0,O.mapActions)("strategy",{setSymbol:R.STRATEGY_ACTIONS_TYPE.SET_SYMBOL,initSupportedSymbols:R.STRATEGY_ACTIONS_TYPE.INIT_SUPPORTED_SYMBOLS,initBusinessConfig:R.STRATEGY_ACTIONS_TYPE.INIT_BUSINESS_CONFIG})),{},{initWebsocket:function(t){var e=this,n=this.$heroMix.getInstance();n.registerEventListener("open",(function(){e.subscribeCommonData(),t&&t()})),n.begin()},subscribeCommonData:function(){var t=this,e=this.$heroMix.getInstance();if(e.subscribe("tickerAll",{instType:"sp",instId:"default"},(function(data){data.data&&t.setAllTicker(data.data)})),this.isLogin){var n=getCookie("bt_sessonid")||getCookie("bt_rtoken");e.login(n,(function(data){0===data.code&&e.subscribe("account",{instType:"spbl",instId:"default"},(function(data){t.updateUserWallets(data.data.map((function(t){return D(D({},t),{},{tokenId:t.coinName})})))}))}))}},subscribeSymbolData:function(t){var e=this,n=this.getSpotBaseInfo(t).symbolCode,r=this.$heroMix.getInstance();if(r.changeProduct(t),this.wsSymbolDataListenerId&&r.removeEventListener("open",this.wsSymbolDataListenerId),this.wsSymbolDataListenerId=r.registerEventListener("open",(function(){e.wsBookId&&r.unsubscribe(e.wsBookId),e.wsBookId=r.subscribe("books15",{instType:"sp",instId:n},(function(data){var t=data.data[0];data.arg.instId===n&&e.updateSpotDepth(t)}))})),this.isLogin){var o=getCookie("bt_sessonid")||getCookie("bt_rtoken");this.wsUserDataListenerId&&r.removeEventListener("open",this.wsUserDataListenerId),this.wsUserDataListenerId=r.registerEventListener("open",(function(){r.login(o,(function(data){if(0===data.code){var param={instType:"spbl",instId:"default"};r.subscribe("currentStrategy",param,(function(data){"snapshot"===data.action?e.setCurrentStrategyList((function(){return data.data})):"update"===data.action&&e.setCurrentStrategyList((function(t){var e=(0,_.default)(t);return data.data.forEach((function(t){var n=e.findIndex((function(e){return e.strategyId===t.strategyId}));n>=0?-1==+t.version?e.splice(n,1):e[n]=t:e.push(t)})),e.sort((function(a,b){return+b.createTime-+a.createTime})),e}))})),r.subscribe("historyStrategy",param,(function(data){data.data.length&&("snapshot"===data.action?e.setHistoryStrategyList((function(){return data.data})):"update"===data.action&&e.setHistoryStrategyList((function(t){return[].concat((0,_.default)(data.data),(0,_.default)(t)).splice(0,20)})))}))}}))}))}}}),beforeRouteUpdate:function(t,e,n){var r=t.params.symbolId;if(r){var o=this.getSpotBaseInfo(r);this.setSymbol({symbolId:r,businessLine:o.businessLine}),this.subscribeSymbolData(r),n()}},mounted:function(){var t=this;window.isReadyPromise.then((function(){(0,Y.hideGlobalLoading)(),(0,Y.clearLauncher)(),t.setSymbol({symbolId:""}),t.initWebsocket();var e=t.$route.params.symbolId,n=[1];if(t.initBusinessConfig(n),t.initSupportedSymbols({businessLines:n,gridType:1}).then((function(n){var r=n.find((function(t){return t.symbolId===e}));if(r)t.setSymbol({symbolId:e,businessLine:r.businessLine}).then((function(){t.subscribeSymbolData(e)}));else{var o=n[0].symbolId;t.$router.push(t.$i18n.path("spot-strategy/"+o))}})),1==+C.default.get(C.CacheKey.SPOT_STRATEGY_GUIDE)){var r=t.$useDialog()(G.default,{type:"spot",auto:!0}),o=(0,h.default)(r,2),c=o[0],d=o[1];c.then((function(t){"confirm"===t.type&&(t.check&&C.default.set(C.CacheKey.SPOT_STRATEGY_GUIDE,0),d())}))}})).catch((function(t){console.log(">>> system error:",t)}))},beforeDestroy:function(){this.$heroMix.getInstance().selfDestruct(),this.clearAll()}};e.default=U},7328:function(t,e,n){},8548:function(t,e,n){"use strict";n(7328)},9345:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var r=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"strategy-symbolId-page"},[e("div",{staticClass:"strategy-bit-market"},[e("strategy-detail")],1),this._v(" "),e("div",{staticClass:"strategy-aside"},[e("strategy-aside")],1),this._v(" "),e("div",{staticClass:"strategy-depth-history"},[e("strategy-depth-and-history",{staticClass:"strategy-layout-item strategy-depth-and-history"})],1),this._v(" "),e("div",{staticClass:"strategy-kline-chart"},[e("strategy-kline")],1),this._v(" "),e("div",{staticClass:"strategy-cur-history"},[e("current-strategy-and-history")],1)])},o=[]}}]);
//# sourceMappingURL=9e022e1b9d73632084b8.js.map